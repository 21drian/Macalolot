<?xml version="1.0" encoding="UTF-8"?>

<?import java.net.URL?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.Priority?>
<?import javafx.scene.text.Font?>
<?import javafx.geometry.Insets?>

<AnchorPane minHeight="700.0" minWidth="1190.0" prefHeight="700.0" prefWidth="1190.0" style="-fx-background-color: linear-gradient(to bottom, #f8f9fa 0%, #e9ecef 100%);" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="pos.controller.TransactionController">

    <stylesheets>
        <URL value="@/pos/css/transaction.css" />
    </stylesheets>

    <VBox minHeight="700.0" minWidth="1190.0" prefHeight="700.0" prefWidth="1190.0" spacing="16" AnchorPane.topAnchor="0.0" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0">
        <padding>
            <Insets top="20" right="20" bottom="20" left="20" />
        </padding>

        <!-- Header Section with Glass Effect -->
        <HBox alignment="CENTER_LEFT" spacing="12" style="-fx-background-color: rgba(255,255,255,0.95); -fx-padding: 18 24; -fx-background-radius: 12; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.12), 12, 0, 0, 3); -fx-border-color: rgba(148,8,87,0.1); -fx-border-width: 1; -fx-border-radius: 12;" minHeight="70">
            <VBox spacing="2">
                <Label style="-fx-font-weight: bold; -fx-text-fill: #1a1a1a;" text="Point of Sale">
                    <font><Font name="Arial" size="26" /></font>
                </Label>
                <Label style="-fx-text-fill: #6c757d; -fx-font-size: 13px;" text="Transaction Management System" />
            </VBox>
            
            <Region HBox.hgrow="ALWAYS" />
            
            <!-- Quick Stats (Optional - can be populated via controller) -->
            <VBox alignment="CENTER" spacing="2" style="-fx-background-color: #f8f9fa; -fx-padding: 8 16; -fx-background-radius: 8;">
                <Label style="-fx-font-size: 11px; -fx-text-fill: #6c757d;" text="Today's Sales" />
                <Label style="-fx-font-weight: bold; -fx-font-size: 16px; -fx-text-fill: #940857;" text="â‚±0.00" />
            </VBox>
            
            <Separator orientation="VERTICAL" />
            
            <Button onAction="#handleLogout" prefHeight="42" prefWidth="110" style="-fx-background-color: linear-gradient(to bottom, #495057 0%, #343a40 100%); -fx-text-fill: white; -fx-background-radius: 8; -fx-cursor: hand; -fx-font-size: 14px; -fx-font-weight: 600; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 8, 0, 0, 2);" text="â†ª Logout">
                <font><Font name="Arial" size="14" /></font>
            </Button>
        </HBox>

        <SplitPane dividerPositions="0.58" VBox.vgrow="ALWAYS" style="-fx-background-color: transparent;">
            
            <!-- LEFT PANEL: Products Section -->
            <AnchorPane minWidth="600" style="-fx-background-color: rgba(255,255,255,0.95); -fx-background-radius: 12; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.12), 12, 0, 0, 3); -fx-border-color: rgba(148,8,87,0.08); -fx-border-width: 1; -fx-border-radius: 12;">
                <VBox spacing="14" AnchorPane.topAnchor="16.0" AnchorPane.bottomAnchor="16.0" AnchorPane.leftAnchor="20.0" AnchorPane.rightAnchor="20.0">
                    
                    <!-- Products Header -->
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <Label style="-fx-font-weight: bold; -fx-font-size: 18px; -fx-text-fill: #2c3e50;" text="ðŸ“¦ Products Catalog" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label style="-fx-background-color: #940857; -fx-text-fill: white; -fx-padding: 4 12; -fx-background-radius: 12; -fx-font-size: 11px; -fx-font-weight: 600;" text="LIVE" />
                    </HBox>
                    
                    <!-- Enhanced Search Bar -->
                    <VBox spacing="8">
                        <TextField fx:id="txtSearch" onKeyReleased="#searchProducts" promptText="ðŸ” Search by product name, ID, or type..." style="-fx-background-color: #f8f9fa; -fx-background-radius: 10; -fx-border-color: #dee2e6; -fx-border-radius: 10; -fx-border-width: 1.5; -fx-padding: 12 16; -fx-font-size: 14px; -fx-prompt-text-fill: #adb5bd; -fx-effect: innershadow(gaussian, rgba(0,0,0,0.05), 4, 0, 0, 1);" />
                        <HBox spacing="8">
                            <Label style="-fx-text-fill: #6c757d; -fx-font-size: 11px;" text="ðŸ’¡ Tip: Press Enter to search" />
                        </HBox>
                    </VBox>
                    
                    <!-- Products Table with Enhanced Styling -->
                    <TableView fx:id="productTable" VBox.vgrow="ALWAYS" style="-fx-background-color: white; -fx-background-radius: 10; -fx-border-color: #e9ecef; -fx-border-radius: 10; -fx-border-width: 1; -fx-effect: innershadow(gaussian, rgba(0,0,0,0.03), 5, 0, 0, 1);">
                        <columns>
                            <TableColumn fx:id="pIdCol" prefWidth="70" text="ID" style="-fx-alignment: CENTER;" />
                            <TableColumn fx:id="pNameCol" prefWidth="230" text="Product Name" />
                            <TableColumn fx:id="pPriceCol" prefWidth="110" text="Price" style="-fx-alignment: CENTER-RIGHT;" />
                            <TableColumn fx:id="pDiscountCol" prefWidth="100" text="Discount" style="-fx-alignment: CENTER;" />
                            <TableColumn fx:id="pStockCol" prefWidth="90" text="Stock" style="-fx-alignment: CENTER;" />
                            <TableColumn fx:id="pTypeCol" prefWidth="110" text="Category" style="-fx-alignment: CENTER;" />
                            <TableColumn fx:id="pActionCol" prefWidth="140" text="Action" style="-fx-alignment: CENTER;" />
                        </columns>
                    </TableView>
                    
                    <!-- Products Footer Info -->
                    <HBox alignment="CENTER_LEFT" spacing="16" style="-fx-background-color: #f8f9fa; -fx-padding: 10 16; -fx-background-radius: 8;">
                        <Label style="-fx-text-fill: #6c757d; -fx-font-size: 12px;" text="ðŸ“Š Total Products:" />
                        <Label style="-fx-text-fill: #495057; -fx-font-weight: 600; -fx-font-size: 12px;" text="0" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label style="-fx-text-fill: #6c757d; -fx-font-size: 12px;" text="Click 'Add' to include items in cart" />
                    </HBox>
                </VBox>
            </AnchorPane>

            <!-- RIGHT PANEL: Cart + Payment Section -->
            <AnchorPane minWidth="450" style="-fx-background-color: rgba(255,255,255,0.95); -fx-background-radius: 12; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.12), 12, 0, 0, 3); -fx-border-color: rgba(148,8,87,0.08); -fx-border-width: 1; -fx-border-radius: 12;">
                <VBox spacing="14" AnchorPane.topAnchor="16.0" AnchorPane.bottomAnchor="16.0" AnchorPane.leftAnchor="20.0" AnchorPane.rightAnchor="20.0">
                    
                    <!-- Cart Header -->
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <Label style="-fx-font-weight: bold; -fx-font-size: 18px; -fx-text-fill: #2c3e50;" text="ðŸ›’ Shopping Cart" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label style="-fx-background-color: #e9ecef; -fx-text-fill: #495057; -fx-padding: 4 12; -fx-background-radius: 12; -fx-font-size: 11px; -fx-font-weight: 600;" text="0 ITEMS" />
                    </HBox>

                    <!-- Cart Table -->
                    <TableView fx:id="cartTable" prefHeight="280" VBox.vgrow="ALWAYS" style="-fx-background-color: white; -fx-background-radius: 10; -fx-border-color: #e9ecef; -fx-border-radius: 10; -fx-border-width: 1; -fx-effect: innershadow(gaussian, rgba(0,0,0,0.03), 5, 0, 0, 1);">
                        <columns>
                            <TableColumn fx:id="cNameCol" prefWidth="170" text="Item" />
                            <TableColumn fx:id="cQtyCol" prefWidth="55" text="Qty" style="-fx-alignment: CENTER;" />
                            <TableColumn fx:id="cPriceCol" prefWidth="85" text="Price" style="-fx-alignment: CENTER-RIGHT;" />
                            <TableColumn fx:id="cDiscCol" prefWidth="65" text="Disc" style="-fx-alignment: CENTER;" />
                            <TableColumn fx:id="cSubCol" prefWidth="100" text="Subtotal" style="-fx-alignment: CENTER-RIGHT;" />
                            <TableColumn fx:id="cRemoveCol" prefWidth="90" text="Remove" style="-fx-alignment: CENTER;" />
                        </columns>
                    </TableView>

                    <Separator />

                    <!-- Enhanced Total Section with Gradient -->
                    <VBox spacing="8" style="-fx-background-color: linear-gradient(to right, #940857 0%, #c41766 100%); -fx-padding: 16 20; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(148,8,87,0.3), 10, 0, 0, 4);">
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <Label style="-fx-font-size: 14px; -fx-font-weight: 500; -fx-text-fill: rgba(255,255,255,0.9);" text="Subtotal:" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Label style="-fx-font-weight: 600; -fx-font-size: 16px; -fx-text-fill: white;" text="â‚±0.00" />
                        </HBox>
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <Label style="-fx-font-size: 14px; -fx-font-weight: 500; -fx-text-fill: rgba(255,255,255,0.9);" text="Discount:" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Label style="-fx-font-weight: 600; -fx-font-size: 16px; -fx-text-fill: white;" text="- â‚±0.00" />
                        </HBox>
                        <Separator style="-fx-background-color: rgba(255,255,255,0.3);" />
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <Label style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: white;" text="TOTAL:" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Label fx:id="lblTotal" style="-fx-font-weight: bold; -fx-font-size: 28px; -fx-text-fill: white; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 4, 0, 0, 2);" text="â‚±0.00" />
                        </HBox>
                    </VBox>

                    <!-- Customer Selection with Icon -->
                    <VBox spacing="8">
                        <Label style="-fx-font-weight: 600; -fx-font-size: 13px; -fx-text-fill: #495057;" text="ðŸ‘¤ Customer Information" />
                        <ComboBox fx:id="cmbCustomer" maxWidth="Infinity" promptText="Walk-in customer or select from list..." style="-fx-background-color: #f8f9fa; -fx-background-radius: 8; -fx-border-color: #dee2e6; -fx-border-radius: 8; -fx-border-width: 1.5; -fx-font-size: 13px; -fx-padding: 10;" />
                    </VBox>

                    <!-- Payment Section with Modern Cards -->
                    <VBox spacing="10">
                        <Label style="-fx-font-weight: 600; -fx-font-size: 13px; -fx-text-fill: #495057;" text="ðŸ’³ Payment Details" />
                        <HBox spacing="12" alignment="CENTER">
                            <!-- Amount Paid Card -->
                            <VBox spacing="6" HBox.hgrow="ALWAYS" style="-fx-background-color: #f8f9fa; -fx-padding: 14; -fx-background-radius: 10; -fx-border-color: #dee2e6; -fx-border-width: 1.5; -fx-border-radius: 10;">
                                <Label style="-fx-font-size: 11px; -fx-text-fill: #6c757d; -fx-font-weight: 600;" text="AMOUNT PAID" />
                                <TextField fx:id="txtPayment" onKeyReleased="#computeChange" promptText="0.00" style="-fx-background-color: white; -fx-background-radius: 6; -fx-border-color: #ced4da; -fx-border-radius: 6; -fx-border-width: 1; -fx-padding: 10; -fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #495057;" />
                            </VBox>
                            
                            <!-- Change Card -->
                            <VBox spacing="6" HBox.hgrow="ALWAYS" style="-fx-background-color: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); -fx-padding: 14; -fx-background-radius: 10; -fx-border-color: #28a745; -fx-border-width: 1.5; -fx-border-radius: 10;">
                                <Label style="-fx-font-size: 11px; -fx-text-fill: #155724; -fx-font-weight: 600;" text="CHANGE" />
                                <Label fx:id="lblChange" style="-fx-font-weight: bold; -fx-font-size: 22px; -fx-text-fill: #28a745;" text="â‚±0.00" />
                            </VBox>
                        </HBox>
                    </VBox>

                    <!-- Enhanced Checkout Button with Gradient and Animation -->
                    <Button onAction="#checkout" maxWidth="Infinity" prefHeight="52" style="-fx-background-color: linear-gradient(to right, #940857 0%, #c41766 100%); -fx-text-fill: white; -fx-background-radius: 10; -fx-cursor: hand; -fx-font-size: 17px; -fx-font-weight: bold; -fx-effect: dropshadow(gaussian, rgba(148,8,87,0.4), 12, 0, 0, 4); -fx-border-color: rgba(255,255,255,0.2); -fx-border-width: 1; -fx-border-radius: 10;" text="âœ“ COMPLETE CHECKOUT">
                        <font><Font name="Arial Bold" size="17" /></font>
                    </Button>
                    
                    <!-- Footer Note -->
                    <HBox alignment="CENTER" style="-fx-padding: 4;">
                        <Label style="-fx-text-fill: #adb5bd; -fx-font-size: 11px; -fx-font-style: italic;" text="Press checkout to complete transaction" />
                    </HBox>
                </VBox>
            </AnchorPane>

        </SplitPane>
    </VBox>
</AnchorPane>